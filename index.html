# Interactive Public Health Journals Table with DT package
# This R script creates an HTML page with an interactive table using DT

# Install and load required libraries
if (!require(htmltools)) {
  install.packages("htmltools")
}
if (!require(DT)) {
  install.packages("DT")
}

library(htmltools)
library(DT)

# Create a data frame with journal information
# Note: APCs are subject to change and may vary; these are for demonstration.
journals_df <- data.frame(
  Title = c(
    "The Lancet Public Health",
    "American Journal of Public Health",
    "Bulletin of the World Health Organization",
    "BMC Public Health",
    "International Journal of Environmental Research and Public Health",
    "Journal of Public Health",
    "European Journal of Public Health",
    "PLOS ONE",
    "Environmental Health Perspectives",
    "Global Health Action"
  ),
  ISSN = c(
    "2468-2667",
    "1541-0048",
    "0042-9686",
    "1471-2458",
    "1660-4601",
    "1741-3842",
    "1464-360X",
    "1932-6203",
    "1552-9924",
    "1654-9880"
  ),
  Publisher = c(
    "Elsevier",
    "American Public Health Association",
    "World Health Organization",
    "BioMed Central (Springer Nature)",
    "MDPI",
    "Oxford University Press",
    "Oxford University Press",
    "Public Library of Science",
    "National Institute of Environmental Health Sciences",
    "Taylor & Francis"
  ),
  Impact_Factor = c(
    29.9,
    9.6,
    13.5,
    3.3,
    4.6,
    4.0,
    4.4,
    3.7,
    11.0,
    3.4
  ),
  APC_USD = c(
    "$6,300",
    "$3,500",
    "Free",
    "$2,890",
    "$3,200",
    "$3,850",
    "$4,224",
    "$2,250",
    "Free",
    "$1,800"
  ),
  Access_Type = c(
    "Hybrid",
    "Hybrid", 
    "Full OA",
    "Full OA",
    "Full OA",
    "Hybrid",
    "Hybrid",
    "Full OA",
    "Full OA",
    "Full OA"
  ),
  Website = c(
    "https://www.thelancet.com/journals/lanpub/home",
    "https://ajph.aphapublications.org/",
    "https://www.who.int/bulletin/en/",
    "https://bmcpublichealth.biomedcentral.com/",
    "https://www.mdpi.com/journal/ijerph",
    "https://academic.oup.com/jpubhealth",
    "https://academic.oup.com/eurpub",
    "https://journals.plos.org/plosone/",
    "https://ehp.niehs.nih.gov/",
    "https://www.tandfonline.com/journals/zgha20"
  ),
  stringsAsFactors = FALSE
)

# Create clickable links for journal titles
journals_df$Title <- paste0('<a href="', journals_df$Website, '" target="_blank" style="color: #0056b3; text-decoration: none;">', 
                           journals_df$Title, '</a>')

# Remove the Website column since it's now embedded in Title
journals_df$Website <- NULL

# Create the complete HTML page with embedded interactive table
create_interactive_page <- function() {
  
  # Create the datatable
  dt_table <- datatable(
    journals_df,
    options = list(
      pageLength = 10,
      autoWidth = TRUE,
      searching = TRUE,
      ordering = TRUE,
      info = TRUE,
      lengthChange = TRUE,
      dom = 'Bfrtip',
      scrollX = TRUE,
      columnDefs = list(
        list(width = '250px', targets = 0),  # Title column
        list(width = '100px', targets = 1),  # ISSN column
        list(width = '200px', targets = 2),  # Publisher column
        list(width = '80px', targets = 3),   # Impact Factor column
        list(width = '100px', targets = 4),  # APC column
        list(width = '100px', targets = 5)   # Access Type column
      )
    ),
    rownames = FALSE,
    class = 'cell-border stripe hover',
    colnames = c('Journal Title', 'ISSN', 'Publisher', 'Impact Factor', 'APC (USD)', 'Access Type'),
    escape = FALSE  # This allows HTML in the Title column
  )
  
  # Convert datatable to HTML string
  dt_html <- as.character(dt_table)
  
  # Create complete HTML page
  html_content <- paste0('<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Public Health Journals Directory</title>
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem 1rem;
        }
        
        .container {
            max-width: 1200px;
            margin: auto;
            padding: 2rem;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid #667eea;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            color: #6c757d;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }
        
        .stats-row {
            display: flex;
            justify-content: space-around;
            margin: 1.5rem 0;
            padding: 1rem;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 8px;
            color: white;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            display: block;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .dataTables_wrapper {
            padding-top: 1rem;
        }
        
        .dataTables_filter input {
            border: 2px solid #e9ecef;
            border-radius: 6px;
            padding: 0.5rem;
        }
        
        .dataTables_filter input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        
        table.dataTable tbody tr:hover {
            background-color: #f8f9fa !important;
        }
        
        .footer {
            margin-top: 2rem;
            text-align: center;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 8px;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .stats-row {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Public Health Journals Directory</h1>
            <p>Interactive database of leading journals with Article Processing Charges (APCs) and impact factors</p>
            
            <div class="stats-row">
                <div class="stat-item">
                    <span class="stat-value">10</span>
                    <span class="stat-label">Journals Listed</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value">29.9</span>
                    <span class="stat-label">Highest Impact Factor</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value">2</span>
                    <span class="stat-label">Free to Publish</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value">$3,400</span>
                    <span class="stat-label">Avg APC (Paid)</span>
                </div>
            </div>
        </div>
        
        <div class="table-responsive">
            ', dt_html, '
        </div>
        
        <div class="footer">
            <p><strong>Note:</strong> APCs are subject to change and may vary based on membership status, institution type, and geographic location.</p>
            <p>Impact factors are approximate values and may vary by year. | Last updated: ', format(Sys.Date(), "%B %d, %Y"), '</p>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>

</body>
</html>')
  
  return(html_content)
}

# Generate the HTML content
html_page_content <- create_interactive_page()

# Save the HTML file
writeLines(html_page_content, "index.html")

# Print confirmation message
cat("Interactive HTML file \'index.html\' has been created successfully!\n")
cat("Features included:\n")
cat("- Interactive sorting and filtering\n") 
cat("- Responsive design\n")
cat("- Clickable journal links\n")
cat("- Search functionality\n")
cat("- Modern styling with Bootstrap\n")
cat("File location:", file.path(getwd(), "index.html"), "\n")

# Optional: Open the HTML file in default browser
# browseURL("index.html")
